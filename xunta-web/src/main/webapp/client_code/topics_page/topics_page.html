<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
		<title>话题列表页</title>
		<link rel="stylesheet" type="text/css" href="topics_page.css"/>
		<link rel="stylesheet" type="text/css" href="topics_page_web.css"/>
		<link rel="stylesheet" type="text/css" href="../css/popup.css"/>
		<link rel="stylesheet" type="text/css" href="../css/common_web.css"/>
		<link rel="stylesheet" type="text/css" href="alter_userimage.css"/>

		<!--让输入框的提示字颜色变淡-->
		<style>
		::-webkit-input-placeholder { /* WebKit, Blink, Edge */
			opacity:  0.2;
		}
		:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
			opacity:  0.2;
		}
		::-moz-placeholder { /* Mozilla Firefox 19+ */
			opacity:  0.2;
		}
		:-ms-input-placeholder { /* Internet Explorer 10-11 */
			opacity:  0.2;
		}
		</style>

	</head>
	<body>
		<!--<img id="imageundertopiclist" src="image/windblowgrass-2.gif"/>-->
		<!--<div id="topbar"></div>-->

		<div id="showatloaded" class="showatloaded">

			<!-- 弹框搜索 -->
				<div id="search-container" class="search-container">
					<div class="search-head" id="search-head">
						<span style="position: absolute;top: 1px;left: 6px;width: .8em;">	<img src="../image/search.png" class="h-search-img"></span>
						<input id="_keywords" class="h-input" type="text" onkeypress="if(event.keyCode==13){Javascript:doSearch()}" autofocus placeholder="搜索我的话题"/>
						<img src="../image/return9.png" class="h-return-img" onclick="doSearch()"/>
					</div>
					<img src="../image/close.png" class="h-close-img" onclick="closeSearch()"/>
					<div id="showonlineoffline" ><img src="../image/signal-gray.png" onclick="wsConnect()" />
					</div>

					<div id="showouseroprate" ><img src="../image/exit.png" onclick="logOff()" />
					</div>
					
				</div>

			<!--div id="notification"
			<div id="" class="cursor"><img src="" onclick="showAccount()" />
				<div id="disableLayer" class="disableLayer"></div>
				<div id="showonlineoffline" ><img src="../image/signal-gray.png" onclick="wsConnect()" />
				</div>

				<div class="ImageBox" id="ImageBox">
					<table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td class="lt"></td>
							<td class="t"></td>
							<td class="rt"></td>
						</tr>
						<tr>
							<td class="l"></td>
							<td class="box"><h3 class="tit"><a class="cls" href="javascript:;" onclick="closeImageBox()" title="关闭">关闭</a></h3>
							<div>
								<div id="preview">
									<img id="imghead" width="170" height="170" border="0">无预览时的默认图像
								</div>
								<a href="javascript:;" class="file-upload">
								<input id="file" type="file" onchange="previewImage(this)">
								选择头像 </a>
								<button id="upload" type="button" onclick="upload()" class="upload">
									上 传
								</button>
							</div></td>
							<td class="r"></td>
						</tr>
						<tr>
							<td class="lb"></td>
							<td class="b"></td>
							<td class="rb"></td>
						</tr>
					</table>
					<s><i></i></s>
				</div>
			</div>
			<div id="account" class="cursor">
				<div 
				style="margin-bottom: 7px;	text-align: right;height: 22px;font-size: 14px;border-bottom: 1px solid #cccccc" onclick="openHomePage()">
					个人主页
				</div>
				<div id="username" onclick="alterNickname()">
					username
				</div>
				<div id="alterUserimage" onclick="alterUserimage()">
					更改头像
				</div>
				<div id="logOff" onclick="logOff()">
					<div>
						重新登录
					</div>
					<img src="../image/exit.png" />
				</div>
			</div>-->
			
			<!--
			<div id="topspace">
			</div>-->

			<div id="topic_list"  class="topic_list">
				
				<!--提问分享块-->
				<div class="topic_top">
					<!--头像-->
					<div class="userimg">
						<img src="" onclick="openHomePage()" />
					</div>

					<div class="createnewtopic" id="createnewtopic" onclick="enterDialogPage_NewTopic()">
						<div class="createtopicimg"><img src="../image/create_topic.png" /></div>
						<div style="opacity:0.5;padding-top:4px;float:left;font-size:13px;padding-left:8px;">我有话要说</div>
						<div class="createtopiccontent">提问，分享，交易</div>
						<!--气泡三角-->
						<div class="triangle">
							<img src="../image/triangle.png" >
						</div>
					</div>
					
				</div>

				<!-- 这段不要删! 将用于简化appendelement这部分代码,也用于样式调试: xu 10.15.2015-->
				<!--div class="topic">
				<div class="latesttime">10-02-22</div>
				<div class="topictitle">标题title	<div class="unread">13asdff</div>
				</div>
				<div></div>
				<div class="recentmsg">最新消息1</div>
				<div></div>
				<div class="recentmsg">最新消息2,最新消息2</div>
				</div-->
			</div>
			<div class="getmoretopics cursor"onclick="getMoreTopicList()">
				<div >
					+
				</div>
				<div>
					更多话题
				</div>
			</div>
		</div>

		<div id="search-list-container" class="search-list-container">
		<div id="search_content" class="_search-content">
				<!--<div class="topic-content">-->
					<!--<div class="_titleDiv">-->
						<!--<div class="topic-Title">语擎开发讨论组</div>-->
					<!--</div>-->
					<!--<div class="_topicMsgDiv">-->
						<!--<div class="topicMsg"><a href="javascript:;">wsx123</a>：<span>人类首次11sqeqewqeqwe</span><span class="_msgTime" >12-26 11:00</span></div>-->
						<!--<div class="topicMsg"><a href="javascript:;">wsx123</a>：<span>人类首次11sqeqewqeqwe</span><span class="_msgTime">12-26 11:00</span></div>-->
						<!--<div class="topicMsg"><a href="javascript:;">wsx123</a>：<span>人类首次11sqeqewqeqwe</span><span class="_msgTime">12-26 11:00</span></div>-->
					<!--</div>-->
					<!--<div class="topicMsgMoreDiv"><span class="topicMsgMoreText">1 more</span></div>-->
				<!--</div>-->
			<div id="_searchTopicMore" class="topicMoreDiv"><img src="" />&nbsp;<span id="topicMoreText"></span></div>
		</div>
		</div>
	</body>
	<script type="text/javascript" src="../script/jquery-1.11.3.min.js"></script>
	<script type="text/javascript" src="../script/common-xunta.js"></script>
	<script type="text/javascript" src="../script/common-xunta_web.js"></script>
	<script type="text/javascript" src="../script/popup.js"></script>
	<script type="text/javascript" src="topics_page.js"></script>
	<script type="text/javascript" src="topics_page_web.js"></script>
	<script type="text/javascript">
		var userId;
		//var unionid;//第三方原生ID
		var userName;
		var userImg;
		
		var pageTitle;
		var adminName;
		var adminImageurl;
		
		var projectType;
		var domain;
		var userAgent;
		var dialogPageName = 0;
		var currentOpenDialogPageId = 'null';
		//记录当前打开聊天页面的ID，如果没有在聊天页面上则 = null; 10.13 FANG
		var countKeybacks = 0;
		//用于记录点击回退键的次数,超过30秒则清零. 达到10次,可以打开index.html页,以查看log信息.
		var requestTopicNum = 20;
		//每次请求话题数
		var requestTopicPage = 1;
		//记录请求话题的次数，每次请求20个话题。
		//$("#showatloaded").hide();//?0113 这三个hide改为在css中display:none
		//$("#imageundertopiclist").hide();
		//$(".getmoretopics").hide();
		//		function readyMethod() {//?0112 取消这个方法,如果需要另用windows.ready来做. 隐藏的句子放在外面. 这样 获得更多 的加号就不会闪一下才消失. App上也需要同样的修改.
		//		}

		var _default_topics_num = 10;    //搜索的话题数，默认10条
		var _default_posters_num = 3;   //话题下消息数，默认3条
		var _search_page = 1;  //搜索话题页
		var _keywords;     //搜索内容


		function start(pageParamsStr) {//web:在openWin时通过ready后回调,再跨页执行方式来启动的第一个方法.
			//1。11 新增，   显示Log日志后点击return事件返回到话题列表页时是没有参数的，data为''，所以下面加个判断条件，为''就结束该方法  FANG
			retrievePageParams(pageParamsStr); 
			prepareTopicsPage();
			execRoot("setTopicsPageOpenMark()");//可能还有其它表示列表页打开的标志.
			execRoot("setCurrentPageId('topics_page')");  
			showTopicList(topicList);
			//web上不需任何侦听. addListeners(); //这个方法是空的,是为了让topics_page页面与app保持一致.
			setTimeout(function() {
				$("#showonlineoffline>img").attr("src","../image/signal-orange.png");
				$("body").prepend("<img id='imageundertopiclist' src='../image/imageundertopiclist.jpg'/>");
				$("#imageundertopiclist").fadeIn(1500);
			}, 1000);
			
			//$("#account").show();
		}
		
		function prepareTopicsPage(){
			/*这个地方要修改:允许微信和QQ登录下也可以修改头像.//?
			if(userinfoObj.type!='mobilephone'){//只有手机登录时用户才能修改头像
				$("#alterUserimage").hide();
			}else{
				$("#alterUserimage").show();
			}*/
			$(".userimg>img").attr("src", userImg);
			//$("#username").text(userName);
			
			//if ( projectType == "WEB" ){
			//	if ( userAgent[0] == "PC" ){
			//		$("#userimage").css("right","32px");//向左让出右侧的滚动条.
			//	}
			//}
			
		}

		function retrievePageParams(pageParamsStr){
			if (pageParamsStr == '') {
				toast("打开列表页时发现传递的参数为空.请与开发者联系.");
				return;
			}
			//console.log(pageParamsStr);
			topicList = JSON.parse(pageParamsStr.topiclist);//注意不能直接parse(pageParamsStr),原因不明.必须parse下面一级的键值对.
			//topicList = pageParamsStr.topiclist;
			//注意不能直接parse(pageParamsStr),原因不明.必须parse下面一级的键值对.
			//var publicVars = JSON.parse(pageParamsStr.publicVars);
			var publicVars = pageParamsStr.publicVars;
			domain = publicVars.domain;
			projectType = publicVars.projectType;
			userAgent = publicVars.userAgent;
			//console.log(userAgent);	console.log(userAgent[0]);	console.log(userAgent[1]);
			pageTitle = publicVars.pageTitle;
		    adminName = publicVars.adminName;
		    adminImageurl = publicVars.adminImageurl;
		    console.log("adminName:"+adminName);
			var userinfoObj = publicVars.userInfo;
			userId = userinfoObj.uid;
			userName = userinfoObj.name;
			userImg = userinfoObj.image;
			//unionid = userinfoObj.unionid;
			//topicList = Parameter.topiclist;
		}

		//点击搜索框width变化
		$(function(){
			$('.h-input').click(function(){
				$('.search-head').attr('style','width:70%');
				$('.h-close-img').show();
				$('.h-return-img').show();
			});
		});

		//点击x搜索框产生的变化
		$('.h-close-img').click(function(){
            $('.search-head').attr('style','width:35%');
			$('.h-close-img').attr('style','display:none');
			$('.h-return-img').hide();
        });

	</script>
</html>